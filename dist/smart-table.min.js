/*!
 * SmartTable - v0.1.1
 * Developed by Andrei Belokopytov
 * Licensed under the MIT license
 *
 */

!function(a){"use strict";function b(a){this.cssClass=q,a.filter&&(this.cssClass+=a.filter.cssClass?" "+a.filter.cssClass:"",this.parser=a.filter.valueParser)}function c(a){c["super"].apply(this,arguments),this.getFilterElement=function(){return l("input",this.cssClass,{type:"text",placeholder:a.title})}}function d(a){d["super"].apply(this,arguments),this.cssClass+=" "+r,this.condition=[],this.getFilterElement=function(){var b=document.createDocumentFragment(),c=l("input",this.cssClass+=" "+s,{type:"text",placeholder:a.title}),d=l("input",this.cssClass+=" "+t,{type:"text",placeholder:a.title});return b.appendChild(c),b.appendChild(d),b}}function e(a){e["super"].apply(this,arguments),this.getFilterElement=function(){var b,c,d=l("select",this.cssClass),e=0,f=a.selectOptions.length;for(b=l("option","",{value:""}),d.appendChild(b);f>e;e++)c=a.selectOptions[e],b=l("option",this.cssClass,{value:c.value},c.text),d.appendChild(b);return d}}function f(a){var c=this,d=n;this._dataset=[],this._filtered=[],this._columnsFilters={},a.cssClass&&(d+=a.tableCssClass),"string"==typeof a.element?this.el=document.querySelector(a.element):this.el=a.element,this.columns=a.columns||[],this.columns.forEach(function(a){"index"===a.type&&(a.isIndex=!0,a.noFilter=!0,a.noSort=!0),a.noFilter||(c._columnsFilters[a.property]=b.createFilter(a))}),this.getTableData=function(){},a.actions&&(this.getTableData=a.actions.getData),this._getColumnValue=function(a,b){var c,d=a;if("string"!=typeof b.property)throw Error("Column property should be a sting");return c=b.property.split("."),c.length&&c.forEach(function(a){d=d&&void 0!==d[a]&&null!==d[a]?d[a]:null}),d},this._render=function(){for(var a,b=m(this.columns,this._filtered),c=this.tbodyElem.children.length;c--;)a=this.tbodyElem.children[c],"TR"===a.tagName&&this.tbodyElem.removeChild(a);this._setColumns(b),this.tbodyElem.appendChild(b)},this._clearFilters=function(){var a=this.theadElem.querySelectorAll("input, select");Array.prototype.forEach.call(a,function(a){a.value=""})},this._clearSort=function(){var a=this.theadElem.querySelectorAll("th");Array.prototype.forEach.call(a,function(a){a.classList.remove(z),a.classList.remove(A)})},this._setColumns=function(){var a,b,c=this,d=function(a,b){var d;d=c.tableElem.querySelectorAll('col[data-colindex="'+b+'"], th[data-colindex="'+b+'"]'),[].forEach.call(d,function(b){b.style.display=a})};this.columns.forEach(function(c,e){a=e+1,b=c.hidden?"none":"",d(b,a)},this)},this.refresh=function(){var a=this;this._dataset=[],this._filtered=[],this._clearFilters(),this._clearSort(),this.getTableData(function(b){var c,d;b.forEach(function(b){d={},a.columns.forEach(function(e){e.property&&(c=a._getColumnValue(b,e),d[e.property]=c)}),a._dataset.push(d)}),a._filtered=a._dataset,a._render()})},function(){var a,b,e,f,g,h="",i={},j=function(a){var b,d,e,f=a.target;"TH"===f.tagName&&f.classList.contains(y)&&(b=f.cellIndex,d=c.columns[b],f.classList.contains(z)?(e=A,c.sort(d,e)):(e=z,c.sort(d,e)),[].forEach.call(c.headersBar.children,function(a){"TH"===a.tagName&&(a.classList.remove(z),a.classList.remove(A))}),f.classList.add(e))},k=function(a){var b,d,e,f=a.target;("INPUT"===f.tagName||"SELECT"===f.tagName)&&(b=f.closest("th"),d=c.columns[b.cellIndex],e=c._columnsFilters[d.property],f.classList.contains(r)?f.classList.contains(s)?e.setCondition(f.value,0):f.classList.contains(t)&&e.setCondition(f.value,1):e.setCondition(f.value),c.filter())};this.tableElem=l("table",d,{cols:this.columns.length}),this.theadElem=l("thead"),this.tbodyElem=l("tbody"),this.headersBar=l("tr",o),this.filtersBar=l("tr",p),this.columns.forEach(function(d,j){if(f=j+1,d.noSort||(h=y),i["data-colindex"]=f,a=l("th",h,i,d.title),c.headersBar.appendChild(a),a=l("th","",i),c._columnsFilters[d.property]&&(g=c._columnsFilters[d.property],a.appendChild(g.getFilterElement())),c.filtersBar.appendChild(a),b=l("col","",i),d.width){if(e=parseInt(d.width,10),isNaN(e))throw{message:"Column width should be a number"};e+="px",b.style.width=e}c.tableElem.appendChild(b)}),this.filtersBar.addEventListener("input",k),this.filtersBar.addEventListener("change",k),this.headersBar.addEventListener("click",j),this.theadElem.appendChild(this.headersBar),this.theadElem.appendChild(this.filtersBar),this.tableElem.appendChild(this.theadElem),this.tableElem.appendChild(this.tbodyElem),this.el.appendChild(this.tableElem),this.refresh()}.apply(this)}function g(a,b){var c=function(){};return c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=b,a["super"]=b,a}function h(){for(var a=0;a<arguments.length;a++)if(null===arguments[a]||void 0===arguments[a])return!0;return!1}function i(a,b){return b?a.toString().indexOf(b)>=0:!0}function j(a,b){var c=b[0],d=b[1];return d||c?c?d?d>=a&&a>=c:a>=c:d>=a:!0}function k(a,b){return b&&a!==b?!1:!0}function l(a,b,c,d){var e,f;if(a=document.createElement(a),b&&(a.className=b),c)for(e in c)c.hasOwnProperty(e)&&(f=c[e],a.setAttribute(e,f));return d&&(a.innerText=d),a}function m(a,b){var c,d,e,f,g={},h=document.createDocumentFragment();return Array.isArray(b)&&(b.length?b.forEach(function(b,f){c=l("tr","",{"grid-rowindex":f}),a.forEach(function(a,h){a.hidden||(g["data-colindex"]=h+1,d=l("td","",g),a.isIndex?d.innerText=f+1:(e=b[a.property],e&&("function"==typeof a.formatter?d.innerHTML=a.formatter(e):d.innerText=e)),c.appendChild(d))}),h.appendChild(c)}):(f=a.filter(function(a){return!a.hidden}),c=l("tr",u,{"grid-rowindex":1}),d=l("td",u,{colspan:f.length},"No data"),c.appendChild(d),h.appendChild(c))),h}var n="smart-table",o="smart-table-headers-bar",p="smart-table-filters-bar",q="filter",r="range-filter",s="range-min",t="range-max",u="no-data",v="text",w="range",x="select",y="sorted",z="sort-asc",A="sort-desc";b.prototype={check:function(a){return h(a)?!1:this.comparator(a,this.condition)},setCondition:function(a,b){this.parser&&(a=this.parser(a)),h(b)?this.condition=a:(Array.isArray(this.condition)||(this.condition=[]),this.condition[b]=a)}},b.createFilter=function(a){switch(a.type){case v:return new c(a);case w:return new d(a);case x:return new e(a);default:return new c(a)}},g(c,b),c.prototype.comparator=i,g(d,b),d.prototype.comparator=j,g(e,b),e.prototype.comparator=k,f.prototype={filter:function(){var a,b,c,d,e=this;this._filtered=[],this._dataset.forEach(function(f){a=!0;for(b in f)if(f.hasOwnProperty(b)&&(d=e._columnsFilters[b],d&&(c=f[b],a=d.check(c),!a)))break;a&&e._filtered.push(f)}),this._render()},sort:function(a,b){var c=this,d=1;b||(b=z),b===A&&(d=-1),c._filtered.sort(function(b,c){return b[a.property]>=c[a.property]?d:b[a.property]<c[a.property]?-1*d:void 0}),c._render()},toggleColumns:function(a){var b,c=this;Array.isArray(a)||(a=[a]),a.forEach(function(a){b=c.columns[a-1],b&&("undefined"==typeof b.hidden||b.hidden===!1?b.hidden=!0:b.hidden=!1)}),this._render()},toggleFilters:function(){"none"!==this.filtersBar.style.display?this.filtersBar.style.display="none":this.filtersBar.style.display=""}},a.SmartTable=f}(this),Element.prototype.closest||(Element.prototype.closest=function(a){"use strict";for(var b=this,c=Element.prototype.matches||Element.prototype.msMatchesSelector;b;){if(c.call(b,a))return b;b=b.parentElement}return null});
//# sourceMappingURL=smart-table.min.js.map